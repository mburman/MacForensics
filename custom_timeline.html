<html>
  <head>
    <link href="css/jquery-ui-1.10.3.custom/blitzer/jquery-ui-1.10.3.custom.css" rel="stylesheet">
	  <script src="js/jquery-ui-1.10.3.custom/jquery-1.9.1.js"></script>
	  <script src="js/jquery-ui-1.10.3.custom/jquery-ui-1.10.3.custom.js"></script>

    <script type="text/javascript" src="js/xdate.js"></script>
    <script type="text/javascript" src="js/paper.js"></script>
    <script type="text/javascript" src="js/custom_timeline/custom.js"></script>
    <script type="text/paperscript" canvas="myCanvas">
      $(document).ready(function () {
        parseJSON("http://localhost:8000/gen/json_file_custom.json");
      });

      // A timeline event.
      function Event(title, description, start) {
        this.title = title;
        this.description = description;
        this.start = new Date(start);
      }

      // Parse a JSON file of events.
      function parseJSON(json_file) {
        var events = new Array();

        // This is asynchonous.
        var jqxhr = $.getJSON(json_file, function (json) {
          $.each(json.events, function (index, item) {
            event = new Event(item.title, item.description, item.start);
            events.push(event);
          });
        });

        jqxhr.always(function() {
          return drawTimeline(events);
        });
      }

      // Draw the timeline.
      function drawTimeline(events) {
        console.log("Number of events: " + events.length);

        // Sort in ascending order.
        events = events.sort(
          function(a,b) {
            return parseFloat(a.start.getTime()) - parseFloat(b.start.getTime())
          }
        );

        // Draw the timeline.
        drawTimelineWithMonthGranularity(events);
      }


    </script>
  </head>

  <body>
    <canvas id="myCanvas" />
  </body>
</html>
